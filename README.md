# kimariji_master

百人一首の決まり字を語呂合わせ付きで暗記でき、覚えているかのチェックをブラウザだけで練習できるシンプルなPWAです。100枚の取り札画像と決まり字データをあらかじめ含んでおり、通信が不安定な場所でもテンポを崩さずに練習できます。

## 公開ページ

- https://kg9n3n8y.github.io/kimariji_master/

## 特長

- 決まり字チェックモードで、選択した札のみをテンポ良く表示
- 「語呂合わせ付き学習モード」で画像・歌番号・作者を一画面で復習
- 逆向き札の出題や決まり字グループ単位の出題制御が可能
- オフライン対応のPWA。初回アクセス時に全札画像と語呂合わせスライドを一括キャッシュします

## PWAとしての使い方

1. Chrome / Edge などの対応ブラウザで公開ページを開きます
2. アドレスバーの「インストール」アイコン、またはメニューの 「アプリをインストール」を選択します  
   （iOS Safari の場合は共有メニューから「ホーム画面に追加」を選びます）
3. インストール後はホーム画面やアプリ一覧から全画面表示で起動でき、オフラインでも直前に選んだ札設定のまま練習できます

## ディレクトリガイド

- `index.html` : 画面構造とメタ情報
- `style.css` : UI 全体のスタイル定義
- `script.js` : 出題ロジック、設定画面、語呂合わせビューの制御
- `fudalist.js` : 決まり字データ（番号・読み・語呂合わせ画像パス等）
- `sw.js` : PWA 用サービスワーカー。全アセットのプリキャッシュとナビゲーションフォールバックを担当
- `manifest.json` : PWA メタデータ
- `torifuda/`, `goro_slide/`, `goro_thumbnail/` : 札画像・語呂合わせ画像

## 開発者向けメモ

### ローカル実行

このプロジェクトは静的ファイルのみで構成されています。Service Worker を使うため、必ず HTTP サーバー経由で開いてください。

```bash
cd kimariji_master
python3 -m http.server 4173
```

ブラウザで http://localhost:4173 を開けば動作確認できます。確認後は `Ctrl + C` でサーバーを止めてください。

### キャッシュ更新

- 全アセットのバージョン管理は `sw.js` の `CACHE_VERSION` で行っています。アセット変更時はバージョン文字列を上げると確実に更新されます。
- `fudalist.js` に新しい札や語呂合わせ画像を追加した場合、サービスワーカーが自動的に対象画像をプリキャッシュします（手動リストの更新は不要です）。

### その他

- PWA のスタート URL は `./?source=pwa` です。オフラインでの初回起動に備えて `manifest.json` と `sw.js` の設定を揃えています。
- 主要カラーは `#E1DAC3`（背景）と `#336633`（アクションボタン）です。テーマカラーを変える場合は `manifest.json` と `<meta name="theme-color">` を同時に更新してください。
